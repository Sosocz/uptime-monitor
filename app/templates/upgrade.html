{% extends "base.html" %}
{% block title %}Upgrade to PRO{% endblock %}
{% block page_title %}Upgrade Plan{% endblock %}
{% block content %}
<div class="max-w-5xl mx-auto space-y-12 fade-in">
    <div class="text-center mb-12">
        <h1 class="text-5xl font-bold mb-4 text-gray-900">Upgrade to PRO</h1>
        <p class="text-xl text-gray-600">Unlock intelligent monitoring and see exactly why your sites go down</p>
    </div>

    <!-- Value Proposition -->
    <div class="card p-8 mb-8" style="background: linear-gradient(135deg, rgba(37, 99, 235, 0.05), rgba(79, 70, 229, 0.05)); border: 2px solid #2563eb;">
        <div class="text-center">
            <div class="text-6xl mb-4">üöÄ</div>
            <h2 class="text-3xl font-bold text-gray-900 mb-4">We don't just tell you your site is down.<br>We tell you WHY.</h2>
            <p class="text-gray-600 text-lg">Most monitors alert you too late. TrezApp detects issues before they become incidents and tells you exactly how to fix them.</p>
        </div>
    </div>

    <!-- Pricing Card -->
    <div class="grid md:grid-cols-2 gap-8">
        <!-- FREE Plan -->
        <div class="card p-8">
            <div class="text-center mb-6">
                <h3 class="text-2xl font-bold text-gray-900 mb-2">FREE</h3>
                <div class="text-4xl font-black text-gray-900 mb-4">‚Ç¨0<span class="text-lg font-normal text-gray-500">/month</span></div>
            </div>
            <ul class="space-y-3 text-gray-600 mb-8">
                <li>‚úì Up to 10 monitors</li>
                <li>‚úì 5-minute checks</li>
                <li>‚úì Email alerts</li>
                <li>‚úì Basic uptime tracking</li>
                <li class="text-gray-400">‚úó No root cause analysis</li>
                <li class="text-gray-400">‚úó No recommendations</li>
                <li class="text-gray-400">‚úó No reports</li>
            </ul>
            <div class="text-center">
                <div class="text-gray-600 font-semibold">Current Plan</div>
            </div>
        </div>

        <!-- PRO Plan -->
        <div class="card p-8" style="background: linear-gradient(135deg, rgba(37, 99, 235, 0.05), rgba(79, 70, 229, 0.05)); border: 2px solid #2563eb;">
            <div class="absolute top-4 right-4">
                <span class="badge badge-success" style="background:#10b981;color:#fff;">RECOMMENDED</span>
            </div>
            <div class="text-center mb-6">
                <h3 class="text-2xl font-bold text-gray-900 mb-2">PRO</h3>
                <div class="text-5xl font-black text-gray-900 mb-1">‚Ç¨9,99<span class="text-lg font-normal text-gray-500">/month</span></div>
                <div class="text-sm text-gray-500">or ‚Ç¨119,88/year (save 21%)</div>
            </div>
            <ul class="space-y-3 text-gray-700 mb-8">
                <li><strong>‚úì Unlimited monitors</strong></li>
                <li><strong>‚úì 1-minute checks</strong> (5x faster)</li>
                <li><strong>‚úì Intelligent root cause analysis</strong></li>
                <li><strong>‚úì Fix recommendations</strong></li>
                <li><strong>‚úì Money & time tracking</strong></li>
                <li><strong>‚úì Client-ready PDF reports</strong></li>
                <li><strong>‚úì Health Score & Site DNA</strong></li>
                <li><strong>‚úì White-label status pages</strong></li>
                <li>‚úì Priority support</li>
            </ul>
            <button id="upgradeBtn" class="btn-primary w-full" style="padding:16px;">
                <span style="font-size:18px;font-weight:700;">Upgrade to PRO Now</span>
            </button>
            <div class="text-center text-gray-500 text-sm mt-4">
                Cancel anytime ‚Ä¢ 7-day money back guarantee
            </div>
        </div>
    </div>

    <!-- Social Proof -->
    <div class="card p-8 text-center">
        <div class="text-gray-600 text-sm font-semibold mb-4">TRUSTED BY 1,000+ SITES</div>
        <div class="grid grid-cols-3 gap-8 max-w-2xl mx-auto">
            <div>
                <div class="text-3xl font-bold text-gray-900 mb-1">‚Ç¨500K+</div>
                <div class="text-gray-600 text-sm">Downtime prevented</div>
            </div>
            <div>
                <div class="text-3xl font-bold text-gray-900 mb-1">12,847</div>
                <div class="text-gray-600 text-sm">Incidents detected</div>
            </div>
            <div>
                <div class="text-3xl font-bold text-gray-900 mb-1">8 min</div>
                <div class="text-gray-600 text-sm">Avg detection time</div>
            </div>
        </div>
    </div>

    <!-- What You Get -->
    <div>
        <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center">Why TrezApp PRO?</h2>
        <div class="grid md:grid-cols-2 gap-6">
            <div class="card p-6">
                <div class="text-4xl mb-4">üîç</div>
                <h3 class="text-xl font-bold text-gray-900 mb-2">Intelligent Root Cause</h3>
                <p class="text-gray-600">Don't just know your site is down‚Äîunderstand exactly WHY. Database overload? Server timeout? We tell you.</p>
            </div>
            <div class="card p-6">
                <div class="text-4xl mb-4">üí°</div>
                <h3 class="text-xl font-bold text-gray-900 mb-2">Actionable Recommendations</h3>
                <p class="text-gray-600">Get specific steps to fix issues and prevent them from happening again.</p>
            </div>
            <div class="card p-6">
                <div class="text-4xl mb-4">üìä</div>
                <h3 class="text-xl font-bold text-gray-900 mb-2">Client-Ready Reports</h3>
                <p class="text-gray-600">Generate professional PDF reports in 1 click. Perfect for agencies managing client sites.</p>
            </div>
            <div class="card p-6">
                <div class="text-4xl mb-4">üí∞</div>
                <h3 class="text-xl font-bold text-gray-900 mb-2">Revenue Protection</h3>
                <p class="text-gray-600">Track exactly how much money and time your incidents cost. See your ROI instantly.</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
(function() {
    var authToken = localStorage.getItem('token');
    if (!authToken) {
        window.location.href = '/login?redirect=/upgrade';
        return;
    }

    var upgradeBtn = document.getElementById('upgradeBtn');

    upgradeBtn.addEventListener('click', function() {
        upgradeBtn.disabled = true;
        upgradeBtn.querySelector('span').textContent = 'Processing...';

        fetch('/api/stripe/create-checkout', {
            method: 'POST',
            headers: {
                'Authorization': 'Bearer ' + authToken,
                'Content-Type': 'application/json'
            }
        })
        .then(function(response) {
            if (response.status === 401) {
                localStorage.removeItem('token');
                window.location.href = '/login?redirect=/upgrade';
                return null;
            }
            if (!response.ok) {
                return response.json().then(function(data) {
                    throw new Error(data.detail || 'Payment service unavailable');
                });
            }
            return response.json();
        })
        .then(function(data) {
            if (!data) return;
            if (data.checkout_url) {
                window.location.href = data.checkout_url;
            } else {
                alert('Error: ' + (data.detail || 'Failed to create checkout session. Please contact support.'));
                upgradeBtn.disabled = false;
                upgradeBtn.querySelector('span').textContent = 'Upgrade to PRO Now';
            }
        })
        .catch(function(error) {
            console.error('Error:', error);
            var errorMsg = error.message || 'Payment service unavailable. Please contact support at support@trezapp.fr';
            alert(errorMsg);
            upgradeBtn.disabled = false;
            upgradeBtn.querySelector('span').textContent = 'Upgrade to PRO Now';
        });
    });
})();
</script>
{% endblock %}
